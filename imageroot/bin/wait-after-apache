#!/bin/bash

#
# Copyright (C) 2025 Nethesis S.r.l.
# SPDX-License-Identifier: GPL-3.0-or-later
#

set -e

# Wait for Apache to start in the container
for i in {1..60}; do
    echo "Verify apache is up $i/60"
    if /usr/bin/podman exec apache2-app pgrep apache2 >/dev/null 2>&1; then
        echo "Apache is running successfully"
        exit 0
    fi
    sleep 1
done

echo "Apache did not start after 60 seconds" >&2
exit 1
